{"version":3,"sources":["webpack:///webpack/bootstrap ac8c62bc621b6bf3a1d1","webpack:///./src/index.js"],"names":["canvas","document","getElementById","ctx","getContext","width","height","w","h","board","leftDrop","getElementsByClassName","level","status","restart","degreeMap","a","b","game","EllipseOne","x","y","fillStyle","save","color","r","ratioX","ratioY","scale","beginPath","arc","Math","PI","closePath","fill","restore","clearRect","Drop","constructor","degree","direction","draw","addDegree","checkDegree","bubblePop","drop_left","drop_up","drop_right","drop_down","interval","brokenArr","concat","ishit","dropArr","i","length","Board","number","coordinate","init","xInterval","yInterval","count","j","item","push","getInteger","drop","Game","pause","isCleared","addClickEvent","animation","addEventListener","e","preventDefault","offsetX","offsetY","floor","targetDrop","innerHTML","bubblePopMove","splice","isStageCleared","lose","setTimeout","clearTimeout","window","timerID","nextStage","alert","min","max","range","round","random"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ac8c62bc621b6bf3a1d1","\nlet canvas = document.getElementById('canvas')\nlet ctx = canvas.getContext('2d')\ncanvas.width = 600\ncanvas.height = 600\nlet w = canvas.width\nlet h = canvas.height\n\nlet board = document.getElementById('board')\nlet leftDrop = document.getElementsByClassName('dropNumber')[0]\nlet level = document.getElementsByClassName('level')[0]\nlet status = document.getElementsByClassName('status')[0]\nlet restart = document.getElementsByClassName('restart')[0]\n\nlet degreeMap = [\n  { a: 0, b: 0 }, \n  { a: 15, b: 20 },\n  { a: 30, b: 30 },\n  { a: 45, b: 35 },\n  { a: 50, b: 50 },\n  { a: 10, b: 10}, // 爆裂之后的小水滴\n  { a: 0, b: 0 } // 爆裂之后不存在了\n]\n\nlet game = null\n\n// 均匀压缩法\nfunction EllipseOne(ctx, x, y, a, b, fillStyle) {\n  ctx.save()\n  ctx.fillStyle = fillStyle || game.color\n  let r = (a > b) ? a : b\n  let ratioX = a / r\n  let ratioY = b / r\n  ctx.scale(ratioX, ratioY)\n  ctx.beginPath()\n  ctx.arc(x / ratioX, y / ratioY, r, 0, 2 * Math.PI, false)\n  ctx.closePath()\n  ctx.fill()\n  ctx.restore()\n}\n\nfunction clearRect(x, y, r) {\n  ctx.clearRect(x - r / 2, y - r / 2, r, r)\n}\n\nclass Drop {\n  constructor(x, y, degree, direction) {\n    this.x = x\n    this.y = y\n    this.degree = degree || 1\n    this.direction = direction || null\n  }\n\n  draw(degree) {\n    let { a, b } = degreeMap[degree]\n    EllipseOne(ctx, this.x, this.y, a, b)\n  }\n\n  addDegree() {\n    this.degree++\n  }\n\n  checkDegree() {\n    if (this.degree < 4 && this.degree > 0) {\n      this.addDegree()\n      this.draw(this.degree)\n    } else if (this.degree === 4) {\n      this.bubblePop()\n    }\n  }\n\n  bubblePop() {\n    const { x, y } = this\n    this.degree = 6 \n    let drop_left = new Drop(x - 25, y, 5, 'left')\n    let drop_up = new Drop(x, y - 25, 5, 'up')\n    let drop_right = new Drop(x + 25, y, 5, 'right')\n    let drop_down = new Drop(x, y + 25, 5, 'down')\n    const interval = game.board.interval\n    ctx.clearRect(x - interval / 2, y - interval / 2, interval, interval)\n    drop_left.draw(drop_left.degree)\n    drop_up.draw(drop_up.degree)\n    drop_right.draw(drop_right.degree)\n    drop_down.draw(drop_down.degree)\n\n    game.brokenArr = game.brokenArr.concat([drop_left, drop_up, drop_right, drop_down])\n  }\n\n  ishit() {\n    const { x, y } = this\n    if (x < 0 || x > w || y < 0 || y > h) {\n      return true\n    }\n    let dropArr = game.dropArr\n    for (let i = 0; i < dropArr.length; i++) {\n      if (x <= dropArr[i].x + 50 + 10 && x >= dropArr[i].x - 50 - 10 \n        && y <= dropArr[i].y + 50 + 10 && y >= dropArr[i].y - 50 - 10) {\n          // 290 410 || 490 610\n          // 225 250 250 250\n          // console.log('hit', i, x, y)\n          if (dropArr[i].degree > 0 && dropArr[i].degree <= 4) {            \n            if (dropArr[i].degree === 4) {\n              dropArr[i].bubblePop()\n            } else {\n              dropArr[i].addDegree()\n              dropArr[i].draw(dropArr[i].degree)\n            }\n            return true\n          }\n        }\n    }\n    return false\n  }\n}\n\nclass Board {\n  constructor() {\n    this.width = w\n    this.height = h\n    this.number = 6 // 水平竖直方格个数\n    this.coordinate = [] // 存放水滴坐标数组\n    this.interval = w / this.number\n  }\n\n  init() {\n    game.brokenArr = []\n    game.dropArr = []\n    let { number, coordinate } = this\n    const xInterval = w / number\n    const yInterval = h / number\n    let count = 0\n    for (let j = 0; j < number; j++) {\n      for (let i = 0; i < number; i++) {\n        const item = {\n          x: i * xInterval + xInterval / 2,\n          y: j * yInterval + yInterval / 2\n        }\n        coordinate.push(item)\n        let degree = getInteger(0, 4)\n        let drop = new Drop(item.x, item.y)\n        drop.degree = degree\n        count++\n        game.dropArr.push(drop)\n        drop.draw(degree)\n      }\n    }\n  }\n}\n\nclass Game {\n  constructor(color, leftDrop) {\n    this.level = 1\n    this.pause = false\n    this.brokenArr = []\n    this.dropArr = []\n    this.board = null\n    this.color = color || '#1BD369'\n    this.leftDrop = 10 || leftDrop\n    this.isCleared = false\n  }\n\n  init() {\n    let board = new Board()\n    board.init()\n    this.board = board\n    this.addClickEvent()\n    this.animation()\n  }\n\n  addClickEvent() {\n    let board = this.board\n    \n    restart.addEventListener('click', (e) => {\n      this.restart()\n    })\n\n    canvas.addEventListener('click', (e) => {\n      if (this.pause) return\n      e.preventDefault()\n      if (this.pause) {\n        return \n      }\n\n      const { offsetX, offsetY } = e\n      const x = Math.floor(offsetX / board.interval)\n      const y = Math.floor(offsetY / board.interval)\n      let targetDrop = game.dropArr[x + y * board.number]\n\n      if (targetDrop.degree > 0 && targetDrop.degree < 6) {\n        this.leftDrop--\n        leftDrop.innerHTML = this.leftDrop\n      }\n\n      targetDrop.checkDegree()\n    })\n  }\n\n  bubblePopMove() {\n    let brokenArr = game.brokenArr\n    if (brokenArr.length === 0) return \n    for (let i = 0; i < brokenArr.length; i++) {\n      if (!brokenArr[i].ishit()) {\n        clearRect(brokenArr[i].x, brokenArr[i].y, 20)\n        const { direction } = brokenArr[i]\n        switch(direction) {\n          case 'left':\n            brokenArr[i].x--\n            break\n          case 'up':\n            brokenArr[i].y--\n            break\n          case 'right':\n            brokenArr[i].x++\n            break\n          case 'down':\n            brokenArr[i].y++\n            break\n        }\n        brokenArr[i].draw(5)\n      } else {\n        clearRect(brokenArr[i].x, brokenArr[i].y, 20)\n        brokenArr.splice(i, 1)\n      }\n    }\n  }\n\n  isStageCleared() {\n    for(let i = 0; i < game.dropArr.length; i++) {\n      let drop = game.dropArr[i]\n      let { degree } = drop\n      // 为0就是空位置\n      if (!(degree === 6 || degree === 0)) {\n        this.isCleared = false\n        return false\n      }\n    }\n    this.pause = true    \n    this.isCleared = true\n    return true\n  }\n\n  animation() {\n    if (this.leftDrop <= 0 && !this.pause) {\n      this.lose()\n    }\n    if (this.isCleared && this.pause) {\n      this.isCleared = false\n      setTimeout(() => {\n        clearTimeout(window.timerID)                \n        this.nextStage()\n      }, 2000) \n    }\n    // level.innerHTML = `level ${this.level}`\n    // leftDrop.innerHTML = this.leftDrop\n    window.timerID = setTimeout(() => {\n      clearTimeout(window.timerID)\n      this.bubblePopMove()\n      if (!this.isCleared && !this.pause) {\n        this.isStageCleared()        \n      }\n      this.animation()\n    }, 5)\n  }\n\n  nextStage() {\n    clearRect(300, 300, 600, 600)\n    status.innerHTML = 'Next stage!'\n    this.pause = false\n    this.level++\n    level.innerHTML = `level ${this.level}`\n    this.leftDrop += 5\n    leftDrop.innerHTML = this.leftDrop\n\n    game.init()\n  }\n\n  lose() {\n    this.pause = true\n    alert('You lose!')\n    status.innerHTML = 'You lose!'\n  }\n  \n  restart() {\n    clearRect(300, 300, 600, 600)\n    \n    this.level = 1\n    this.leftDrop = 10\n    game.init()\n    level.innerHTML = `level ${this.level}`\n    leftDrop.innerHTML = this.leftDrop\n  }\n}\n\nfunction getInteger(min, max) {\n  let range = max - min\n  return Math.round(Math.random() * range + min)\n}\n\ngame = new Game()\ngame.init()\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}